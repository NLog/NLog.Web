version: 5.0.0.{build}
clone_folder: c:\projects\nlogweb
configuration: Release
image: Visual Studio 2022
platform: Any CPU

nuget:
  project_feed: true
matrix:
  fast_finish: true
build:
  publish_nuget: true
  publish_nuget_symbols: true
  verbosity: quiet
  
skip_tags: true

build_script:
  - ps: .\build.ps1

deploy:
- provider: NuGet
  api_key:
    secure: 5tuxbM+Ujp0ZtaDCGYET23qKr6bJWo/Vzxlf7uTbspaf8R1R7sIe1JqSDHZoK1gV
  on:
    branch: master
test_script:
  - ps: dotnet test tests\NLog.Web.Tests\NLog.Web.Tests.csproj
  - ps: dotnet test tests\NLog.Web.AspNetCore.Tests\NLog.Web.AspNetCore.Tests.csproj

artifacts:
- path: '**\NLog.Web.*.nupkg'
- path: '**\NLog.Web.*.snupkg'
